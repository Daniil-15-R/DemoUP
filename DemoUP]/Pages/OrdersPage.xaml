<Page x:Class="DemoUP_.Pages.OrderPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:DemoUP_.Pages"
      mc:Ignorable="d" 
      d:DesignHeight="450" d:DesignWidth="800"
      Title="Просмотр заказов">

    <Grid Background="{StaticResource PrimaryBackgroundBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Заголовок -->
        <Border Grid.Row="0" 
                Background="{StaticResource SecondaryBackgroundBrush}"
                Padding="15,10">
            <TextBlock Text="Просмотр заказов" 
                      Style="{StaticResource LargeHeaderTextStyle}"
                      HorizontalAlignment="Center"/>
        </Border>

        <!-- Панель управления заказами (видна только администратору) -->
        <Border Grid.Row="1" 
                Background="{StaticResource PrimaryBackgroundBrush}"
                Padding="10,5">
            <StackPanel Orientation="Horizontal">
                <Button x:Name="AddButton"
                        Content="➕ Добавить заказ"
                        Click="AddButton_Click"
                        Margin="0,0,10,0"
                        Padding="10,5"
                        Visibility="Collapsed"
                        ToolTip="Добавить новый заказ (только для администратора)"/>

                <Button x:Name="DeleteButton"
                        Content="❌ Удалить"
                        Click="DeleteButton_Click"
                        Margin="0,0,10,0"
                        Padding="10,5"
                        Visibility="Collapsed"
                        ToolTip="Удалить выбранный заказ (только для администратора)"/>
            </StackPanel>
        </Border>

        <!-- Список заказов -->
        <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto">
            <ItemsControl x:Name="OrdersItemsControl" Margin="20">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <!-- Изменяем на одиночный клик -->
                        <Border Background="White"
       BorderBrush="LightGray"
       BorderThickness="1"
       CornerRadius="5"
       Margin="0,5"
       Padding="15"
       MouseLeftButtonDown="OrderItem_MouseLeftButtonDown"
       Cursor="Hand">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <!-- Основная информация о заказе -->
                                <StackPanel Grid.Column="0">
                                    <!-- Номер заказа -->
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                        <TextBlock Text="Заказ №" 
                                                  Style="{StaticResource NormalTextStyle}"
                                                  FontWeight="Bold"/>
                                        <TextBlock Text="{Binding OrderNumber}"
                                                  Style="{StaticResource NormalTextStyle}"
                                                  FontWeight="Bold"
                                                  Margin="5,0,0,0"/>
                                    </StackPanel>

                                    <!-- Артикул заказа -->
                                    <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
                                        <TextBlock Text="Артикул заказа: "
                                                  Style="{StaticResource SmallTextStyle}"
                                                  Foreground="Gray"/>
                                        <TextBlock Text="{Binding ArticleNumber}"
                                                  Style="{StaticResource SmallTextStyle}"/>
                                    </StackPanel>

                                    <!-- Клиент -->
                                    <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
                                        <TextBlock Text="Клиент: "
                                                  Style="{StaticResource SmallTextStyle}"
                                                  Foreground="Gray"/>
                                        <TextBlock Text="{Binding ClientName}"
                                                  Style="{StaticResource SmallTextStyle}"/>
                                    </StackPanel>

                                    <!-- Статус заказа -->
                                    <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
                                        <TextBlock Text="Статус: "
                                                  Style="{StaticResource SmallTextStyle}"
                                                  Foreground="Gray"/>
                                        <TextBlock Text="{Binding StatusName}"
                                                  Style="{StaticResource SmallTextStyle}"/>
                                    </StackPanel>

                                    <!-- Состав заказа -->
                                    <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
                                        <TextBlock Text="Состав: "
                                                  Style="{StaticResource SmallTextStyle}"
                                                  Foreground="Gray"/>
                                        <TextBlock Text="{Binding OrderComposition}"
                                                  Style="{StaticResource SmallTextStyle}"
                                                  TextWrapping="Wrap"/>
                                    </StackPanel>

                                    <!-- Адрес доставки -->
                                    <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
                                        <TextBlock Text="Адрес: "
                                                  Style="{StaticResource SmallTextStyle}"
                                                  Foreground="Gray"/>
                                        <TextBlock Text="{Binding DeliveryAddress}"
                                                  Style="{StaticResource SmallTextStyle}"
                                                  TextWrapping="Wrap"/>
                                    </StackPanel>

                                    <!-- Дата заказа -->
                                    <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
                                        <TextBlock Text="Дата заказа: "
                                                  Style="{StaticResource SmallTextStyle}"
                                                  Foreground="Gray"/>
                                        <TextBlock Text="{Binding OrderDate, StringFormat=dd.MM.yyyy}"
                                                  Style="{StaticResource SmallTextStyle}"/>
                                    </StackPanel>

                                    <!-- Дата доставки -->
                                    <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
                                        <TextBlock Text="Дата доставки: "
                                                  Style="{StaticResource SmallTextStyle}"
                                                  Foreground="Gray"/>
                                        <TextBlock Text="{Binding DeliveryDate, StringFormat=dd.MM.yyyy}"
                                                  Style="{StaticResource SmallTextStyle}"/>
                                    </StackPanel>
                                </StackPanel>

                                <!-- Блок с количеством товаров и цветным статусом -->
                                <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="15,0,0,0">
                                    <Border Background="{Binding StatusColor}"
                                           CornerRadius="3"
                                           Padding="8,4"
                                           BorderThickness="1"
                                           BorderBrush="LightGray">
                                        <TextBlock Text="{Binding StatusName}"
                                                  Style="{StaticResource SmallTextStyle}"
                                                  Foreground="White"
                                                  FontWeight="Bold"
                                                  HorizontalAlignment="Center"/>
                                    </Border>

                                    <TextBlock Text="{Binding ItemsCount}"
                                              Style="{StaticResource SmallTextStyle}"
                                              HorizontalAlignment="Center"
                                              Margin="0,5,0,0"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>

        <!-- Сообщение при отсутствии заказов -->
        <TextBlock Grid.Row="2"
                  x:Name="NoOrdersText"
                  Text="Заказы не найдены"
                  Style="{StaticResource LargeHeaderTextStyle}"
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center"
                  Visibility="Collapsed"/>
    </Grid>
</Page>